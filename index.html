<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Tycoon Bot</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶∏‡¶¨ CSS ‡¶è‡¶ï‡¶á ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
        /* ‡¶∂‡ßÅ‡¶ß‡ßÅ JavaScript ‡¶Ö‡¶Ç‡¶∂ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶õ‡¶ø */
    </style>
</head>
<body>
    <!-- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶∏‡¶¨ HTML ‡¶è‡¶ï‡¶á ‡¶•‡¶æ‡¶ï‡¶¨‡ßá -->
    
    <!-- ‡¶®‡¶§‡ßÅ‡¶® JavaScript ‡¶°‡¶ø‡¶¨‡¶æ‡¶ó ‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶® -->
    <script>
        // ========== ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ==========
        const BOT_CONFIG = {
            botUsername: "Babu24Bot",  // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ü‡ßá‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ
            adminChatId: "6986255063"
        };
        
        // ========== ‡¶°‡¶ø‡¶¨‡¶æ‡¶ó ‡¶≤‡¶ó ==========
        const DEBUG = true;  // true ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ï‡¶®‡¶∏‡ßã‡¶≤‡ßá ‡¶∏‡¶¨ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
        
        function log(message, data = null) {
            if (!DEBUG) return;
            if (data) {
                console.log(`üîç [DEBUG] ${message}:`, data);
            } else {
                console.log(`üîç [DEBUG] ${message}`);
            }
        }
        
        // ========== ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤ ==========
        let userData = null;
        let data = {
            completed: 0,
            remaining: 100,
            todaysEarning: 0
        };

        // ========== ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ==========
        let tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            log("Telegram WebApp initialized", tg.initDataUnsafe);
        } else {
            log("Telegram WebApp not found - using demo mode");
        }

        // ========== ‡¶Æ‡ßá‡¶á‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ==========
        window.addEventListener('DOMContentLoaded', function() {
            log("DOM loaded - starting initialization");
            initializeUser();
            updateDisplay();
            updateTaskVisualization();
        });

        // ========== ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ==========
        function initializeUser() {
            log("=== STARTING USER INITIALIZATION ===");
            
            let user = null;
            let referrerId = null;
            
            // ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ
            if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
                user = tg.initDataUnsafe.user;
                log("Telegram user found", user);
                
                // start_param ‡¶ö‡ßá‡¶ï
                if (tg.initDataUnsafe.start_param) {
                    const startParam = tg.initDataUnsafe.start_param;
                    log("Start param found", startParam);
                    
                    if (startParam.startsWith('ref_')) {
                        referrerId = startParam.replace('ref_', '');
                        log("‚úÖ Referrer ID extracted from start_param", referrerId);
                    } else {
                        log("‚ùå Start param doesn't start with ref_", startParam);
                    }
                } else {
                    log("‚ùå No start_param found in tg.initDataUnsafe");
                    
                    // URL ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ï
                    const urlParams = new URLSearchParams(window.location.search);
                    const tgWebAppStartParam = urlParams.get('tgWebAppStartParam');
                    if (tgWebAppStartParam) {
                        log("Found tgWebAppStartParam in URL", tgWebAppStartParam);
                        if (tgWebAppStartParam.startsWith('ref_')) {
                            referrerId = tgWebAppStartParam.replace('ref_', '');
                            log("‚úÖ Referrer ID from URL", referrerId);
                        }
                    } else {
                        log("No tgWebAppStartParam in URL");
                    }
                }
            } else {
                // ‡¶°‡ßá‡¶Æ‡ßã ‡¶á‡¶â‡¶ú‡¶æ‡¶∞
                user = {
                    id: Math.floor(Math.random() * 1000000) + 1000000,
                    first_name: "Demo",
                    last_name: "User",
                    username: "demouser",
                    photo_url: "https://via.placeholder.com/80"
                };
                log("Using demo user", user);
            }

            // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶¨‡¶æ ‡¶§‡ßà‡¶∞‡¶ø
            const storageKey = `userData_${user.id}`;
            log("Checking storage key", storageKey);
            
            const savedData = localStorage.getItem(storageKey);

            if (savedData) {
                userData = JSON.parse(savedData);
                log("Existing user loaded from localStorage", userData);
            } else {
                userData = {
                    userId: user.id,
                    firstName: user.first_name,
                    lastName: user.last_name || '',
                    username: user.username || '',
                    photoUrl: user.photo_url || 'https://via.placeholder.com/80',
                    lifetimeEarning: 0,
                    withdrew: 0,
                    totalTasks: 0,
                    referrals: 0,
                    referralEarnings: 0,
                    referralHistory: [],
                    joinDate: new Date().toISOString()
                };
                log("New user created", userData);
                
                // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏
                if (referrerId) {
                    log("Found referrerId for new user", referrerId);
                    
                    if (referrerId !== user.id.toString()) {
                        log("‚úÖ Valid referral - processing now", {
                            referrerId: referrerId,
                            newUserId: user.id
                        });
                        processNewReferral(referrerId, user.id);
                    } else {
                        log("‚ùå Self referral ignored", {
                            referrerId: referrerId,
                            userId: user.id
                        });
                    }
                } else {
                    log("No referrerId found - direct visit");
                }

                localStorage.setItem(storageKey, JSON.stringify(userData));
            }

            // ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
            const today = new Date().toLocaleDateString();
            const taskKey = `taskData_${user.id}_${today}`;
            const savedTaskData = localStorage.getItem(taskKey);

            if (savedTaskData) {
                data = JSON.parse(savedTaskData);
                log("Task data loaded", data);
            } else {
                data = {
                    completed: 0,
                    remaining: 100,
                    todaysEarning: 0
                };
                localStorage.setItem(taskKey, JSON.stringify(data));
                log("New task data created", data);
            }
            
            log("=== USER INITIALIZATION COMPLETE ===");
            log("Final userData", userData);
            log("Final taskData", data);
        }

        // ========== ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ==========
        function processNewReferral(referrerId, newUserId) {
            log("=== PROCESSING NEW REFERRAL ===");
            log("Referrer ID:", referrerId);
            log("New User ID:", newUserId);
            
            // ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®
            if (!referrerId || referrerId === '' || referrerId === 'undefined' || referrerId === 'null') {
                log("‚ùå Invalid referrer ID");
                return false;
            }
            
            if (referrerId === newUserId.toString()) {
                log("‚ùå Self referral ignored");
                return false;
            }
            
            const referrerKey = `userData_${referrerId}`;
            log("Looking for referrer data at key:", referrerKey);
            
            const referrerData = localStorage.getItem(referrerKey);

            if (referrerData) {
                const referrer = JSON.parse(referrerData);
                log("Referrer found", referrer);
                
                // ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ü‡¶ó‡ßá ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ
                const alreadyReferred = referrer.referralHistory && referrer.referralHistory.some(
                    ref => ref.id === `User#${newUserId}`
                );
                
                if (alreadyReferred) {
                    log("‚ùå User already referred by this referrer");
                    return false;
                }
                
                // ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶®
                log("Before update - Referrer stats:", {
                    referrals: referrer.referrals,
                    lifetimeEarning: referrer.lifetimeEarning,
                    referralEarnings: referrer.referralEarnings
                });
                
                // Add referral bonus
                referrer.referrals = (referrer.referrals || 0) + 1;
                referrer.lifetimeEarning = (referrer.lifetimeEarning || 0) + 1.00;
                referrer.referralEarnings = (referrer.referralEarnings || 0) + 1.00;

                // Add to referral history
                if (!referrer.referralHistory) {
                    referrer.referralHistory = [];
                }

                const newReferral = {
                    id: `User#${newUserId}`,
                    earned: 0,
                    status: 'active',
                    joinDate: new Date().toISOString()
                };
                
                referrer.referralHistory.push(newReferral);
                
                // ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶®
                log("After update - Referrer stats:", {
                    referrals: referrer.referrals,
                    lifetimeEarning: referrer.lifetimeEarning,
                    referralEarnings: referrer.referralEarnings,
                    newReferral: newReferral
                });

                localStorage.setItem(referrerKey, JSON.stringify(referrer));
                log("‚úÖ Referral added successfully and saved to localStorage");
                
                // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®
                if (userData && referrerId !== userData.userId.toString()) {
                    showNotification(`üéâ You earned $1.00 from a new referral!`, "success");
                }
                
                return true;
                
            } else {
                log("‚ùå Referrer not found in localStorage - saving as pending");
                
                // ‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£
                const pendingReferrals = JSON.parse(localStorage.getItem('pendingReferrals') || '[]');
                const newPending = {
                    referrerId: referrerId,
                    newUserId: newUserId,
                    timestamp: new Date().toISOString()
                };
                pendingReferrals.push(newPending);
                localStorage.setItem('pendingReferrals', JSON.stringify(pendingReferrals));
                log("Saved as pending referral", newPending);
                
                return false;
            }
        }

        // ========== ‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶ö‡ßá‡¶ï ==========
        function checkPendingReferrals() {
            log("=== CHECKING PENDING REFERRALS ===");
            
            if (!userData) {
                log("No userData - cannot check pending");
                return;
            }
            
            const pendingReferrals = JSON.parse(localStorage.getItem('pendingReferrals') || '[]');
            log("Pending referrals found:", pendingReferrals.length);
            
            if (pendingReferrals.length === 0) {
                return;
            }
            
            const newPending = [];
            let updated = false;
            
            pendingReferrals.forEach(pending => {
                log("Checking pending:", pending);
                
                if (pending.referrerId === userData.userId.toString()) {
                    log("‚úÖ Found pending for current user");
                    
                    if (!userData.referralHistory) {
                        userData.referralHistory = [];
                    }
                    
                    const exists = userData.referralHistory.some(ref => ref.id === `User#${pending.newUserId}`);
                    
                    if (!exists) {
                        userData.referrals = (userData.referrals || 0) + 1;
                        userData.lifetimeEarning = (userData.lifetimeEarning || 0) + 1.00;
                        userData.referralEarnings = (userData.referralEarnings || 0) + 1.00;
                        
                        userData.referralHistory.push({
                            id: `User#${pending.newUserId}`,
                            earned: 0,
                            status: 'active',
                            joinDate: pending.timestamp || new Date().toISOString()
                        });
                        
                        log("‚úÖ Added pending referral to user data");
                        updated = true;
                        showNotification(`üéâ You earned $1.00 from a new referral!`, "success");
                    } else {
                        log("Pending already exists in history");
                    }
                } else {
                    newPending.push(pending);
                }
            });
            
            if (updated) {
                localStorage.setItem('pendingReferrals', JSON.stringify(newPending));
                localStorage.setItem(`userData_${userData.userId}`, JSON.stringify(userData));
                log("Updated userData with pending referrals", userData);
                updateDisplay();
            } else {
                log("No updates needed");
            }
        }

        // ========== ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ==========
        function updateReferralProgress(userId, amount) {
            log("Updating referral progress", { userId, amount });
            
            const allKeys = Object.keys(localStorage);
            let updatedCount = 0;
            
            allKeys.forEach(key => {
                if (key.startsWith('userData_')) {
                    try {
                        const data = JSON.parse(localStorage.getItem(key));
                        
                        if (data.referralHistory && Array.isArray(data.referralHistory)) {
                            let updated = false;
                            
                            data.referralHistory = data.referralHistory.map(ref => {
                                if (ref.id === `User#${userId}`) {
                                    const oldEarned = ref.earned;
                                    ref.earned = (ref.earned || 0) + amount;
                                    
                                    if (ref.earned >= 30) {
                                        ref.status = 'completed';
                                    }
                                    
                                    updated = true;
                                    updatedCount++;
                                    log(`Updated referral earnings: ${oldEarned} -> ${ref.earned}`);
                                }
                                return ref;
                            });
                            
                            if (updated) {
                                localStorage.setItem(key, JSON.stringify(data));
                            }
                        }
                    } catch (e) {
                        console.error('Error updating referral progress:', e);
                    }
                }
            });
            
            if (updatedCount > 0) {
                log(`Updated ${updatedCount} referrer(s)`);
            }
        }

        // ========== ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ==========
        function updateDisplay() {
            if (!userData) return;

            const availableBalance = (userData.lifetimeEarning - userData.withdrew).toFixed(2);

            // ‡¶π‡ßá‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            document.getElementById("header-balance").textContent = availableBalance;

            // ‡¶π‡ßã‡¶Æ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤
            document.getElementById("user-name").textContent = userData.firstName + (userData.lastName ? ' ' + userData.lastName : '');
            document.getElementById("display-user-id").textContent = userData.userId;
            document.getElementById("today-earning").textContent = data.todaysEarning.toFixed(2);
            document.getElementById("lifetime-earning").textContent = userData.lifetimeEarning.toFixed(2);
            document.getElementById("total-tasks").textContent = userData.totalTasks;
            document.getElementById("referral-count").textContent = userData.referrals || 0;

            // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï - ‡¶Ö‡¶ü‡ßã ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü
            const refLink = `https://t.me/${BOT_CONFIG.botUsername}?start=ref_${userData.userId}`;
            document.getElementById("referral-link").textContent = refLink;
            document.getElementById("total-referrals").textContent = userData.referrals || 0;
            document.getElementById("referral-earnings").textContent = (userData.referralEarnings || 0).toFixed(2);

            // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø
            updateReferralHistoryDisplay();
        }

        // ========== ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ==========
        function updateReferralHistoryDisplay() {
            const historyList = document.getElementById("referral-history-list");
            
            if (!userData.referralHistory || userData.referralHistory.length === 0) {
                historyList.innerHTML = '<div class="empty-history">No referral history yet</div>';
                return;
            }
            
            historyList.innerHTML = '';
            
            userData.referralHistory.forEach(referral => {
                const historyItem = document.createElement("div");
                historyItem.className = "history-item";
                
                const progressPercentage = Math.min(100, (referral.earned / 30) * 100);
                
                historyItem.innerHTML = `
                    <div class="history-id">${referral.id}</div>
                    <div class="history-earned">$${referral.earned.toFixed(2)}</div>
                    <div class="history-status ${referral.status === 'active' ? 'status-active' : 'status-pending'}">${referral.status}</div>
                `;
                
                historyList.appendChild(historyItem);
            });
            
            log("Referral history updated", userData.referralHistory);
        }

        // ========== ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßç‡¶ü ==========
        function startTask() {
            if (data.completed >= 100) {
                showNotification("You have completed all tasks for today! Come back tomorrow.", "warning");
                return;
            }
            
            const start = Date.now();
            const ad = window.open("https://www.google.com", "_blank"); // ‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï
            
            if (!ad) {
                showNotification("Please allow popups to complete tasks", "error");
                return;
            }
            
            const check = setInterval(() => {
                if (ad.closed) {
                    clearInterval(check);
                    const duration = (Date.now() - start) / 1000;
                    
                    if (duration >= 2) { // ‡¶ü‡ßá‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø 2 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°
                        data.completed++;
                        data.remaining = 100 - data.completed;
                        data.todaysEarning += 0.025;
                        userData.lifetimeEarning += 0.025;
                        userData.totalTasks++;
                        
                        // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
                        log("Task completed - updating referral progress");
                        updateReferralProgress(userData.userId, 0.025);
                        
                        updateStorage();
                        updateDisplay();
                        updateTaskVisualization();
                        
                        showNotification("‚úÖ Task completed! $0.025 added.", "success");
                        
                        if (data.completed === 100) {
                            userData.lifetimeEarning += 1.00;
                            updateStorage();
                            updateDisplay();
                            showNotification("üéâ Bonus earned!", "success");
                        }
                    } else {
                        showNotification("‚è±Ô∏è Please stay longer!", "error");
                    }
                }
            }, 500);
        }

        // ========== ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ==========
        function updateStorage() {
            localStorage.setItem(`userData_${userData.userId}`, JSON.stringify(userData));
            const today = new Date().toLocaleDateString();
            localStorage.setItem(`taskData_${userData.userId}_${today}`, JSON.stringify(data));
        }

        function updateTaskVisualization() {
            // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ï‡ßã‡¶°
        }

        function showNotification(message, type) {
            // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ï‡ßã‡¶°
            console.log(`NOTIFICATION: ${message} (${type})`);
        }

        function copyReferralLink() {
            const refLink = `https://t.me/${BOT_CONFIG.botUsername}?start=ref_${userData.userId}`;
            navigator.clipboard.writeText(refLink)
                .then(() => showNotification("‚úÖ Link copied!", "success"))
                .catch(() => showNotification("Failed to copy", "error"));
        }

        function show(section) {
            // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶ï‡ßã‡¶°
            if (section === 'profile') {
                checkPendingReferrals();
            }
        }

        // ========== ‡¶°‡¶ø‡¶¨‡¶æ‡¶ó ‡¶ü‡ßÅ‡¶≤‡¶∏ ==========
        window.debugReferral = {
            // ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
            status: function() {
                console.log("=== REFERRAL DEBUG STATUS ===");
                console.log("Bot Username:", BOT_CONFIG.botUsername);
                console.log("Current User:", userData);
                console.log("Task Data:", data);
                
                const pending = JSON.parse(localStorage.getItem('pendingReferrals') || '[]');
                console.log("Pending Referrals:", pending);
                
                // ‡¶∏‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®
                const allUsers = [];
                Object.keys(localStorage).forEach(key => {
                    if (key.startsWith('userData_')) {
                        allUsers.push(JSON.parse(localStorage.getItem(key)));
                    }
                });
                console.log("All Users in DB:", allUsers);
            },
            
            // ‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤
            testReferral: function(referrerId) {
                if (!userData) {
                    console.log("No user data");
                    return;
                }
                console.log(`Testing referral from ${referrerId} to ${userData.userId}`);
                processNewReferral(referrerId, userData.userId);
            },
            
            // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü
            reset: function() {
                if (userData) {
                    localStorage.removeItem(`userData_${userData.userId}`);
                    localStorage.removeItem('pendingReferrals');
                    console.log("Data reset - refresh page");
                    location.reload();
                }
            },
            
            // ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶Ø‡ßã‡¶ó
            addReferral: function(referrerId, newUserId) {
                processNewReferral(referrerId, newUserId);
            }
        };

        console.log("‚úÖ Debug tools loaded - type 'debugReferral.status()' in console");
    </script>
</body>
</html>
